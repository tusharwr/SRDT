 
 SELECT DISTINCT A.EMPLID 
 ,( 
 SELECT SUM(Q.item_amt)-SUM(Q.applied_amt) 
  FROM ps_item_sf_vw Q 
 WHERE Q.EMPLID=A.EMPLID 
   AND Q.item_amt>'0') AS TOT_USA_COUNT, ( 
 SELECT DISTINCT B.DESCRSHORT 
  FROM PS_STDNT_CAR_TERM AZ 
  ,PS_XL_ACAD_LVL_VW B 
 WHERE AZ.EMPLID=A.EMPLID 
   AND AZ.ACAD_LEVEL_BOT=B.FIELDVALUE 
   AND AZ.fully_enrl_dt=( 
 SELECT MAX(D.fully_enrl_dt) 
  FROM PS_STDNT_CAR_TERM D 
 WHERE D.emplid=A.EMPLID)) AS GPGB_SS_ID, ( 
 SELECT X.NAME 
  FROM ps_SCC_PRI_NAME_VW X 
 WHERE X.EMPLID=A.EMPLID 
   AND X.EFFDT=( 
 SELECT MAX(Y.EFFDT) 
  FROM ps_SCC_PRI_NAME_VW Y 
 WHERE X.emplid=Y.emplid 
   AND Y.EFFDT<=CURRENT_DATE )) AS NAME , ( 
 SELECT Z.CAMPUS_ID 
  FROM PS_PERSON_SA Z 
 WHERE Z.emplid=A.EMPLID) AS CAMPUS_ID, ( 
 SELECT U.DESCR 
  FROM ps_ACAD_PROG W 
  ,ps_ACAD_PROG_tbl U 
 WHERE W.EMPLID=A.EMPLID 
   AND W.ACAD_PROG=U.ACAD_PROG 
   AND W.EFFDT=( 
 SELECT MAX(V.EFFDT) 
  FROM ps_ACAD_PROG V 
 WHERE W.emplid=V.emplid 
   AND V.EFFDT<=CURRENT_DATE ) 
   AND W.EFFSEQ=( 
 SELECT MAX(M.EFFSEQ) 
  FROM ps_ACAD_PROG M 
 WHERE M.emplid=W.emplid 
   AND M.EFFDT<=CURRENT_DATE) ) AS DESCR , SUM(CASE WHEN A.ACCOUNT_NBR='TUITION001' 
   AND DESCR NOT LIKE '%Caution Money TUT%' THEN replace(A.ITEM_AMT,'-') END) AS TUITION_FEES , SUM(CASE WHEN A.ACCOUNT_NBR='HOSTEL001' 
   AND A.DESCR NOT LIKE '%Caution Money HOS%' THEN replace(A.ITEM_AMT,'-') END) AS CMPNY_FEE_AMT , SUM(CASE WHEN A.ACCOUNT_NBR='BUS001' THEN replace(A.ITEM_AMT,'-') END) AS APPL_FEE_AMT , SUM(CASE WHEN A.ACCOUNT_NBR='APPL001' THEN replace(A.ITEM_AMT,'-') END) AS APPL_FEE_PAID , SUM(CASE WHEN A.ACCOUNT_NBR='OTHER001' THEN replace(A.ITEM_AMT,'-') END) AS DEDUCT_CMPNY_FEE , SUM(CASE WHEN A.ACCOUNT_NBR='TUITION001' 
   AND A.DESCR LIKE '%Caution Money TUT%' THEN replace(A.ITEM_AMT,'-') END) AS DED_PFEE_ADJ , SUM(CASE WHEN A.ACCOUNT_NBR='HOSTEL001' 
   AND A.DESCR LIKE '%Caution Money HOS%' THEN replace(A.ITEM_AMT,'-') END) AS DED_PFEE_YTD ,SUM(replace(A.ITEM_AMT,'-')) AS TOTAL_AMT, (TO_CHAR (TO_DATE (TRUNC (SUM(replace(A.ITEM_AMT,'-'))),'j'), 'Jsp') || ' Rupees') AS DESCR100, ( 
 SELECT SUM(replace(N.ITEM_AMT 
 ,'-')) 
  FROM PS_CSH_OFFRCT_T_VW O 
  ,PS_ITEM_SF_VW N 
 WHERE N.EMPLID=A.EMPLID 
   AND N.ITEM_AMT LIKE '-%' 
   AND N.RECEIPT_NBR=O.RECEIPT_NBR 
   AND TENDER_KEY='CASH' 
   AND N.last_activity_date=( 
 SELECT MAX(NA.last_activity_date) 
  FROM PS_ITEM_SF_VW NA 
 WHERE N.emplid=NA.emplid 
   AND NA.item_amt LIKE '-%' 
   AND last_activity_date<=CURRENT_DATE ) ) AS AMOUNT_PAST_DUE, ( 
 SELECT SUM(replace(N.ITEM_AMT 
 ,'-')) 
  FROM PS_CSH_OFFRCT_T_VW O 
  ,PS_ITEM_SF_VW N 
 WHERE N.EMPLID=A.EMPLID 
   AND N.ITEM_AMT LIKE '-%' 
   AND N.RECEIPT_NBR=O.RECEIPT_NBR 
   AND TENDER_KEY='CHECK' 
   AND N.last_activity_date=( 
 SELECT MAX(NA.last_activity_date) 
  FROM PS_ITEM_SF_VW NA 
 WHERE N.emplid=NA.emplid 
   AND NA.item_amt LIKE '-%' 
   AND last_activity_date<=CURRENT_DATE ) ) AS AMOUNT_PER_POINT, ( 
 SELECT S.check_num_sf 
  FROM PS_ITEM_SF_VW Q 
  ,PS_CSH_OFFRCT_T_VW R 
  ,PS_CSH_OFF_RCPT_T S 
 WHERE Q.EMPLID=A.EMPLID 
   AND Q.ITEM_AMT LIKE '-%' 
   AND Q.RECEIPT_NBR=R.RECEIPT_NBR 
   AND R.TENDER_KEY='CHECK' 
   AND R.RECEIPT_NBR=S.RECEIPT_NBR 
   AND Q.last_activity_date=( 
 SELECT MAX(QB.last_activity_date) 
  FROM PS_ITEM_SF_VW QB 
 WHERE Q.emplid=QB.emplid 
   AND Q.item_amt LIKE '-%' 
   AND last_activity_date<=CURRENT_DATE )) AS BK_PYMT_NBR, ( 
 SELECT SC.tracer_nbr 
  FROM PS_ITEM_SF_VW QA 
  ,PS_CSH_OFFRCT_T_VW RB 
  ,PS_CSH_OFF_RCPT_T SC 
 WHERE QA.EMPLID=A.EMPLID 
   AND QA.ITEM_AMT LIKE '-%' 
   AND QA.RECEIPT_NBR=RB.RECEIPT_NBR 
   AND RB.TENDER_KEY='CHECK' 
   AND RB.RECEIPT_NBR=SC.RECEIPT_NBR 
   AND QA.last_activity_date=( 
 SELECT MAX(QB.last_activity_date) 
  FROM PS_ITEM_SF_VW QB 
 WHERE QA.emplid=QB.emplid 
   AND QA.item_amt LIKE '-%' 
   AND last_activity_date<=CURRENT_DATE )) AS DESCR100_2, ( 
 SELECT SUM(BAL.ACCOUNT_BALANCE) 
  FROM ps_account_sf BAL 
 WHERE BAL.EMPLID=A.EMPLID ) AS AMOUNT_TOTAL, ( 
 SELECT MAX(DT.ABSENCE_DATE) 
  FROM PS_SRMU_SNTFER_TBL DT 
 WHERE DT.EMPLID=A.EMPLID) AS ABSENCE_DATE 
  FROM PS_ITEM_SF_VW A 
 WHERE A.item_amt LIKE '-%' 
   AND A.last_activity_date=( 
 SELECT MAX(b.last_activity_date) 
  FROM PS_ITEM_SF_VW B 
 WHERE A.emplid=B.emplid 
   AND B.item_amt LIKE '-%' 
   AND last_activity_date<=CURRENT_DATE ) 
  GROUP BY EMPLID;